---
title: 闭包是什么，闭包的优缺点
date: 2019-06-26 14:14:40
tags: [闭包, 闭包优缺点 ]
---

闭包是学习js路途上逃避不开的一个难点，在很多工具库，框架中都存在应用。
<!--more-->


##### 什么是闭包

闭包是指可以访问另一个函数作用域的函数。一般情况下创建闭包，在一个函数内部 创建另一函数，通过另一个函数来访问这个函数的局部变量。一般是通过匿名函数的自我调用返回另一个函数，并将它赋给一个变量。

##### 什么是作用域链？

简单来说,作用域链就是函数在定义的时候创建的,用于寻找使用到的变量的值的一个索引,而他内部的规则是,把函数自身的本地变量放在最前面,把自身的父级函数中的变量放在其次,把再高一级函数中的变量放在更后面,以此类推直至全局对象为止.当函数中需要查询一个变量的值的时候,js解释器会去作用域链去查找,从最前面的本地变量中先找,如果没有找到对应的变量,则到下一级的链上找,一旦找到了变量,则不再继续.如果找到最后也没找到需要的变量,则解释器返回undefined.

变量的作用域无非就两种：全局变量和局部变量。

javascript语言的特别之处就在于：函数内部因为上面的作用域链可以直接读取全局变量，但是在函数外部无法读取函数内部的局部变量。


##### 闭包的实现
```
function a(){
  var n = 0;
  function inc(){
    n++; 
    console.log(n);
  }
  return inc;
}
var c = a();
c();  //控制台输出1
c();  //控制台输出2
```

这里 inc 函数访问了构造函数 a 里面的变量 n，所以形成了一个闭包。
后面三句翻译过来就是：  var c = inc;  inc();  inc();

js的每个函数都是一个个小黑屋，它可以获取外界信息，但是外界却无法直接看到里面的内容。
将变量 n 放进小黑屋里，除了 inc 函数之外，没有其他办法能接触到变量 n，而且在函数 a 外定义同名的变量 n 也是互不影响的，这就是所谓的增强“封装性”。
而之所以要用 return 返回函数标识 inc，是因为在 a 函数外部无法直接调用 inc 函数，所以 return inc 与外部联系起来

##### 闭包的优缺点及其用途

优点：避免全局变量的污染；能够读取函数内部的变量；在内存中维护一个变量
缺点：操作不当容易浪费内存，造成内存泄漏

应用场景：实现封装；模拟面向对象，不同的对象(类的实例)拥有独立的成员及状态，互不干涉
